<div class="commentComponent">
  <div *ngIf="!singleThread">
    <app-comment-reply-form
      (commented)="createComment($event)"
      [postId]="postId"
    ></app-comment-reply-form>
  </div>
  <div class="threadDiscussion" *ngIf="singleThread">
    <span class="singleThreadButton">Single Thread</span>
    <span class="headerLine"></span>
    <span class="openThreadButton" (click)="navigateToPost(postId)"
      >See Full Discussion</span
    >
  </div>
  <div class="commentSection">
    <div class="individualComment" *ngFor="let comment of comments$">
      <div class="reddit-post">
        <ng-container
          *ngTemplateOutlet="commentTemplate; context: { $implicit: comment }"
        ></ng-container>
      </div>
    </div>

    <ng-template #commentTemplate let-comment>
      <app-comment-tile
        (collapseToggled)="updateCollapseBool(comment.commentId)"
        (showMoreReplies)="showMoreReplies($event)"
        (replied)="createComment($event)"
        (updateComments)="updateComments()"
        [comment]="comment"
        [currentExposedReplies]="
          comment.repliesMap ? comment.repliesMap.size : 0
        "
        [userComment]="isUserComment(comment)"
      >
      </app-comment-tile>
      <div *ngIf="!comment.isCollapsed">
        <div class="line">
          <div
            class="reply"
            *ngFor="let reply of comment.repliesMap | keyvalue"
          >
            <ng-container
              *ngTemplateOutlet="
                commentTemplate;
                context: { $implicit: reply.value }
              "
            >
            </ng-container>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
